{"uid":"6fb83b4683eefda2","name":"Ambient loop plays random file","fullName":"tests.test_player.TestAmbientMusic#test_ambient_loop_logic","historyId":"7028594b5c90f06d0e5ad2585f85c296","time":{"start":1765103665276,"stop":1765103665277,"duration":1},"description":"\n        Scenario: Run the internal loop method directly.\n        Expectation: Plays sound on AMBIENT channel.\n        ","descriptionHtml":"<pre><code>    Scenario: Run the internal loop method directly.\n    Expectation: Plays sound on AMBIENT channel.\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: expected call not found.\nExpected: Sound('/ambiant/calm.mp3')\n  Actual: not called.","statusTrace":"self = <test_player.TestAmbientMusic object at 0x7fbaf9dd4a10>\nmock_choice = <MagicMock name='choice' id='140440686262352'>\nmock_walk = <MagicMock name='walk' id='140440686432080'>\nplayer = <player.JukeboxPlayer object at 0x7fbae53770d0>\nmock_pygame = <MagicMock name='pygame' id='140440686680656'>\n\n    @allure.story(\"Playback Loop\")\n    @allure.title(\"Ambient loop plays random file\")\n    @patch('player.os.walk')\n    @patch('player.random.choice')\n    def test_ambient_loop_logic(self, mock_choice, mock_walk, player, mock_pygame):\n        \"\"\"\n        Scenario: Run the internal loop method directly.\n        Expectation: Plays sound on AMBIENT channel.\n        \"\"\"\n        mock_walk.return_value = [('/ambiant', [], ['calm.mp3'])]\n        mock_choice.return_value = '/ambiant/calm.mp3'\n    \n        # Set stop event immediately so the loop runs only once\n        player.ambient_stop_event.set()\n    \n        player._ambient_loop(\"dummy_folder\")\n    \n        mock_pygame.mixer.Channel.assert_called_with(2) # AMBIENT_CHANNEL_IDX is 2\n>       mock_pygame.mixer.Sound.assert_called_with('/ambiant/calm.mp3')\n\ntests/test_player.py:203: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <MagicMock name='pygame.mixer.Sound' id='140440686310288'>\nargs = ('/ambiant/calm.mp3',), kwargs = {}\nexpected = \"Sound('/ambiant/calm.mp3')\", actual = 'not called.'\nerror_message = \"expected call not found.\\nExpected: Sound('/ambiant/calm.mp3')\\n  Actual: not called.\"\n\n    def assert_called_with(self, /, *args, **kwargs):\n        \"\"\"assert that the last call was made with the specified arguments.\n    \n        Raises an AssertionError if the args and keyword args passed in are\n        different to the last call to the mock.\"\"\"\n        if self.call_args is None:\n            expected = self._format_mock_call_signature(args, kwargs)\n            actual = 'not called.'\n            error_message = ('expected call not found.\\nExpected: %s\\n  Actual: %s'\n                    % (expected, actual))\n>           raise AssertionError(error_message)\nE           AssertionError: expected call not found.\nE           Expected: Sound('/ambiant/calm.mp3')\nE             Actual: not called.\n\n/opt/hostedtoolcache/Python/3.11.14/x64/lib/python3.11/unittest/mock.py:930: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"mock_pygame","time":{"start":1765103665274,"stop":1765103665275,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"mock_kivy_clock","time":{"start":1765103665275,"stop":1765103665275,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"player","time":{"start":1765103665275,"stop":1765103665276,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"mock_kivy_clock::0","time":{"start":1765103665311,"stop":1765103665311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"mock_pygame::0","time":{"start":1765103665311,"stop":1765103665311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"feature","value":"Ambient Music"},{"name":"story","value":"Playback Loop"},{"name":"epic","value":"Jukebox Player"},{"name":"suite","value":"Ambient Mode"},{"name":"parentSuite","value":"tests"},{"name":"subSuite","value":"TestAmbientMusic"},{"name":"host","value":"runnervmoqczp"},{"name":"thread","value":"2529-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_player"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":5,"broken":0,"skipped":0,"passed":0,"unknown":0,"total":5},"items":[{"uid":"8f20759a72258ed1","reportUrl":"https://TonyJayHunt.github.io/jukebox2/37/#testresult/8f20759a72258ed1","status":"failed","statusDetails":"AssertionError: expected call not found.\nExpected: Sound('/ambiant/calm.mp3')\n  Actual: not called.","time":{"start":1764504653736,"stop":1764504653736,"duration":0}},{"uid":"12c955050b9fdf79","reportUrl":"https://TonyJayHunt.github.io/jukebox2/36/#testresult/12c955050b9fdf79","status":"failed","statusDetails":"AssertionError: expected call not found.\nExpected: Sound('/ambiant/calm.mp3')\n  Actual: not called.","time":{"start":1764504641607,"stop":1764504641607,"duration":0}},{"uid":"6c276f8ce353ed54","reportUrl":"https://TonyJayHunt.github.io/jukebox2/35/#testresult/6c276f8ce353ed54","status":"failed","statusDetails":"AssertionError: expected call not found.\nExpected: Sound('/ambiant/calm.mp3')\n  Actual: not called.","time":{"start":1764504442113,"stop":1764504442114,"duration":1}},{"uid":"550e3751034688d0","reportUrl":"https://TonyJayHunt.github.io/jukebox2/34/#testresult/550e3751034688d0","status":"failed","statusDetails":"AssertionError: expected call not found.\nExpected: Sound('/ambiant/calm.mp3')\n  Actual: not called.","time":{"start":1764504236506,"stop":1764504236506,"duration":0}}]},"tags":[]},"source":"6fb83b4683eefda2.json","parameterValues":[]}